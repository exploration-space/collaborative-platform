$("#formCreateNewProject").on("submit",function(t){t.preventDefault();var e=$(this).serializeObject(),a=jQuery("[name=csrfmiddlewaretoken]").val();$.ajaxSetup({beforeSend:function(t,e){t.setRequestHeader("X-CSRFToken",a)}}),$.ajax({type:"POST",url:"/api/projects/create/",data:JSON.stringify(e),dataType:"json",contentType:"application/json",success:function(t){window.location.href="/projects/"+t.id},error:function(t,e,a){$("#createNewProject").modal("hide"),$("[js-createNewProjectInfo]").text(t.responseJSON.message),$("#createNewProjectInfo").modal("show")}})}),$("[js-listProjectsMine]").DataTable({ajax:{url:"/api/projects/get_mine/",dataSrc:"data"},columns:[{data:"title",fnCreatedCell:function(t,e,a,o,n){$(t).html('<a href="'+$("[js-listProjectsMine]").attr("data-link-project")+a.id+'">'+e+"</a>")}},{data:"contributors",fnCreatedCell:function(t,e,a,o,n){var i="";for(item in e)i+='<a href="'+$("[js-listProjectsMine]").attr("data-link-contributor")+e[item].id+'">'+e[item].first_name+" "+e[item].last_name+"</a>",item!=e.length-1&&(i+=", ");$(t).html(i)}},{data:"modification_date",fnCreatedCell:function(t,e,a,o,n){$(t).html(moment(e).format("DD.MM.YY, HH:mm"))}}],drawCallback:function(){$(".dataTables_paginate > .pagination").addClass("pagination-sm")}}),$("[js-listProjectsPublic]").DataTable({ajax:{url:"/api/projects/get_public/",dataSrc:"data"},columns:[{data:"title",fnCreatedCell:function(t,e,a,o,n){$(t).html('<a href="'+$("[js-listProjectsPublic]").attr("data-link-project")+a.id+'">'+e+"</a>")}},{data:"contributors",fnCreatedCell:function(t,e,a,o,n){var i="";for(item in e)i+='<a href="'+$("[js-listProjectsPublic]").attr("data-link-contributor")+e[item].id+'">'+e[item].first_name+" "+e[item].last_name+"</a>",item!=e.length-1&&(i+=", ");$(t).html(i)}},{data:"modification_date",fnCreatedCell:function(t,e,a,o,n){$(t).html(moment(e).format("DD.MM.YY, HH:mm"))}}],drawCallback:function(){$(".dataTables_paginate > .pagination").addClass("pagination-sm")}});var csrftoken=$("[name=csrfmiddlewaretoken]").val();$.ajaxSetup({beforeSend:function(t,e){t.setRequestHeader("X-CSRFToken",csrftoken)}}),$("[js-makePublicProject]").on("click",function(t){var e=$(this).attr("js-makePublicProject");$.ajax({type:"POST",url:"/api/projects/"+e+"/make_public",success:function(){$("[js-makePublicProject]").toggle2classes("project__button--makepublic","project__button--makepublic-active"),$("[js-makePrivateProject]").toggle2classes("project__button--makeprivate","project__button--makeprivate-active")}})}),$("[js-makePrivateProject]").on("click",function(t){var e=$(this).attr("js-makePrivateProject");$.ajax({type:"POST",url:"/api/projects/"+e+"/make_private",success:function(){$("[js-makePublicProject]").toggle2classes("project__button--makepublic","project__button--makepublic-active"),$("[js-makePrivateProject]").toggle2classes("project__button--makeprivate","project__button--makeprivate-active")}})});var csrftoken=jQuery("[name=csrfmiddlewaretoken]").val();$.ajaxSetup({beforeSend:function(t,e){t.setRequestHeader("X-CSRFToken",csrftoken)}});var options={divID:"files",filesData:"/static/tree.json",rowHeight:35,showTotal:15,paginate:!1,paginateToggle:!1,lazyLoad:!0,useDropzone:!0,uploadURL:"",allowMove:!0,allowArrows:!0,multiselect:!0,hoverClass:"tb-hover",moveClass:"tb-draggable",resolveRows:function(){return[{data:"title",folderIcons:!0,filter:!0,css:"tb-draggable",custom:function(t){return m("a[href='asdasd']",t.data.title)}},{data:"date",filter:!0,custom:function(t){return"folder"!==t.data.kind?moment(t.data.date).format("DD.MM.YY, HH:mm"):""}},{data:"action",sortInclude:!1,filter:!1,css:"tb-actions",custom:function(t){var e=this,a=m("button.tb-button",{onclick:function(a){a.stopPropagation();var o=t.data.title,n=m("div",[m("h3.break-word","Change name"),m("p","Name:"),m("input",{"class":"form-control",value:o,oninput:function(t){o=t.target.value}})]),i=m("div",[m("button",{"class":"btn btn-default m-r-md",onclick:function(){e.modal.dismiss()}},"Cancel"),m("button",{"class":"btn btn-success",onclick:function(){var a="folder"!==t.data.kind?"/api/files/rename/file/":"/api/files/rename/directory/"+t.data.id+"/";$.ajax({type:"PUT",url:a+o,contentType:"application/json",success:function(t){e.modal.dismiss(),e.refreshData()}})}},"OK")]);e.modal.update(n,i)}},m("i",{"class":"fa fa-edit"})),o=m("button.tb-button",{onclick:function(a){a.stopPropagation();var o="",n=m("div",[m("h3.break-word","Create folder"),m("p","Name:"),m("input",{"class":"form-control",value:o,oninput:function(t){o=t.target.value}})]),i=m("div",[m("button",{"class":"btn btn-default m-r-md",onclick:function(){e.modal.dismiss()}},"Cancel"),m("button",{"class":"btn btn-success",onclick:function(){$.ajax({type:"PUT",url:"/api/files/create/directory/"+t.data.id+"/"+o,contentType:"application/json",success:function(t){e.modal.dismiss(),e.refreshData()}})}},"OK")]);e.modal.update(n,i)}},m("i",{"class":"fa fa-folder"})),n=m("button.tb-button",{onclick:function(a){a.stopPropagation();var o=m("div",[m("h3.break-word",'Delete "'+t.data.title+'"?'),m("p","This action is irreversible.")]),n=m("div",[m("button",{"class":"btn btn-default m-r-md",onclick:function(){e.modal.dismiss()}},"Cancel"),m("button",{"class":"btn btn-success",onclick:function(){var a="folder"!==t.data.kind?"/api/files/file/":"/api/files/directory/";$.ajax({type:"DELETE",url:a+t.data.id,contentType:"application/json",success:function(t){e.modal.dismiss(),e.refreshData()}})}},"OK")]);e.modal.update(o,n)}},m("i",{"class":"fa fa-trash"}));return"folder"!==t.data.kind?[a,n]:[a,o,n]}}]},dropEvents:{over:function(t,e){},drop:function(t,e){console.log(e),console.log(t)}},hScroll:null,onselectrow:function(t){},columnTitles:function(){return[{title:"Name",width:"65%",sortType:"text",sort:!0},{title:"Modified",width:"18%",sortType:"date",sort:!0},{title:"",width:"17%",sort:!1}]}},tb=Treebeard(options);